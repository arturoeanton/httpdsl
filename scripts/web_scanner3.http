# Enterprise Web Security Scanner v3.0 - Complete Edition
# Comprehensive vulnerability assessment with URLs and detailed explanations
# Compatible with HTTP DSL v3.1.1
# ================================================

print "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
print "â•‘     ENTERPRISE SECURITY SCANNER v3.0                      â•‘"
print "â•‘     Complete Detection with URLs & Explanations           â•‘"
print "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"

# Authorization and setup
if $ARGC < 2 then
    print ""
    print "âŒ Authorization Required"
    print "Usage: httpdsl web_scanner3.http <domain> <auth-token> [quick]"
    print ""
    print "Options:"
    print "  quick - Run only critical tests for faster scanning"
    print ""
    set $stop 1
else
    set $target $ARG1
    set $auth $ARG2
    set $stop 0
    
    # Check for quick mode
    set $quick_mode 0
    if $ARGC >= 3 then
        if $ARG3 == "quick" then
            set $quick_mode 1
            print ""
            print "âš¡ QUICK MODE ENABLED - Running critical tests only"
        endif
    endif
    
    print ""
    print "ğŸ¯ Target: $target"
    print "ğŸ”‘ Authorization: Validated"  
    print "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    print ""
    
    # Initialize detailed counters
    set $critical 0
    set $high 0
    set $medium 0
    set $low 0
    set $info 0
    set $total_tests 0
    set $vulnerabilities_found 0
    set $passed_tests 0
    set $failed_tests 0
    
    # Initialize vulnerability arrays for reporting
    set $critical_issues ""
    set $high_issues ""
    set $medium_issues ""
    set $low_issues ""
endif

# ================================================
# TEST 1: COMPREHENSIVE SECURITY HEADERS
# ================================================
if $stop == 0 then
    print "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    print "â•‘ [1/25] SECURITY HEADERS ANALYSIS                          â•‘"
    print "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    set $total_tests $total_tests + 1
    
    GET "$target" timeout 5s
    extract status "" as $status
    
    # Extended header checks
    extract header "X-Frame-Options" as $xframe
    extract header "Content-Security-Policy" as $csp
    extract header "Strict-Transport-Security" as $hsts
    extract header "X-Content-Type-Options" as $xcontent
    extract header "X-XSS-Protection" as $xxss
    extract header "Referrer-Policy" as $referrer
    extract header "Permissions-Policy" as $permissions
    
    print "ğŸ“‹ Security Headers Assessment:"
    print ""
    
    # X-Frame-Options check with detailed explanation
    if $xframe empty then
        print "  ğŸ”´ CRITICAL: Missing X-Frame-Options"
        print "     â†³ WHY: Allows clickjacking attacks where your site is embedded in malicious iframes"
        print "     â†³ FIX: Add header 'X-Frame-Options: DENY' or 'SAMEORIGIN'"
        print "     â†³ RISK: Attackers can trick users into clicking hidden elements"
        set $high $high + 1
        set $vulnerabilities_found $vulnerabilities_found + 1
    else
        print "  âœ… X-Frame-Options: $xframe"
        print "     â†³ Protection against clickjacking attacks enabled"
        set $passed_tests $passed_tests + 1
    endif
    
    # Content-Security-Policy check
    if $csp empty then
        print "  ğŸ”´ CRITICAL: Missing Content-Security-Policy"
        print "     â†³ WHY: No protection against XSS, data injection, and other code injection attacks"
        print "     â†³ FIX: Implement CSP with strict directives for scripts, styles, and resources"
        print "     â†³ RISK: Malicious scripts can steal user data and session tokens"
        set $high $high + 1
        set $vulnerabilities_found $vulnerabilities_found + 1
    else
        print "  âœ… CSP configured"
        print "     â†³ Cross-site scripting mitigation active"
        # Analyze CSP strength
        if $csp contains "unsafe-inline" then
            print "     âš ï¸  WARNING: CSP allows 'unsafe-inline' - weakens XSS protection"
            set $medium $medium + 1
            set $vulnerabilities_found $vulnerabilities_found + 1
        endif
        if $csp contains "unsafe-eval" then
            print "     âš ï¸  WARNING: CSP allows 'unsafe-eval' - allows code execution"
            set $medium $medium + 1
            set $vulnerabilities_found $vulnerabilities_found + 1
        endif
    endif
    
    # HSTS check with preload analysis
    if $hsts empty then
        print "  ğŸŸ  HIGH: Missing Strict-Transport-Security"
        print "     â†³ WHY: Allows HTTPS downgrade attacks and man-in-the-middle attacks"
        print "     â†³ FIX: Add 'Strict-Transport-Security: max-age=31536000; includeSubDomains; preload'"
        print "     â†³ RISK: Attackers can intercept communications over HTTP"
        set $high $high + 1
        set $vulnerabilities_found $vulnerabilities_found + 1
    else
        print "  âœ… HSTS enabled: $hsts"
        if $hsts contains "max-age=0" then
            print "     âš ï¸  WARNING: HSTS disabled with max-age=0"
            set $high $high + 1
            set $vulnerabilities_found $vulnerabilities_found + 1
        endif
        if $hsts contains "preload" then
            print "     âœ… BONUS: HSTS preload enabled for maximum security"
        endif
    endif
    
    # Permissions-Policy check
    if $permissions empty then
        print "  ğŸŸ¡ MEDIUM: Missing Permissions-Policy"
        print "     â†³ WHY: No control over browser features and APIs"
        print "     â†³ FIX: Add Permissions-Policy to restrict sensitive APIs"
        print "     â†³ RISK: Third-party scripts can access camera, microphone, location"
        set $medium $medium + 1
        set $vulnerabilities_found $vulnerabilities_found + 1
    else
        print "  âœ… Permissions-Policy configured"
    endif
    
    print ""
    print "ğŸ“Š Header Security Score: $passed_tests/10"
    print ""
endif

# ================================================
# TEST 2: SENSITIVE FILE & DIRECTORY EXPOSURE
# ================================================
if $stop == 0 then
    print "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    print "â•‘ [2/25] SENSITIVE FILE EXPOSURE                            â•‘"
    print "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    set $total_tests $total_tests + 1
    
    print "ğŸ” Scanning for exposed sensitive files..."
    print ""
    
    set $exposed_count 0
    
    # Check Git repository
    GET "$target/.git/config"
    extract status "" as $git_status
    if $git_status == 200 then
        print "  ğŸ”´ CRITICAL: Exposed file: /.git/config"
        print "     â†³ WHY: Git repository exposed, contains source code"
        print "     â†³ FIX: Block .git directory in web server config"
        print "     â†³ RISK: Complete source code disclosure"
        set $critical $critical + 1
        set $exposed_count $exposed_count + 1
        set $vulnerabilities_found $vulnerabilities_found + 1
    endif
    
    # Check environment files
    GET "$target/.env"
    extract status "" as $env_status
    if $env_status == 200 then
        print "  ğŸ”´ CRITICAL: Exposed file: /.env"
        print "     â†³ WHY: Contains API keys, database credentials, secrets"
        print "     â†³ FIX: Move .env outside web root"
        print "     â†³ RISK: Complete system compromise"
        set $critical $critical + 1
        set $exposed_count $exposed_count + 1
        set $vulnerabilities_found $vulnerabilities_found + 1
    endif
    
    # Check config files
    GET "$target/config.php"
    extract status "" as $config_status
    if $config_status == 200 then
        print "  ğŸ”´ CRITICAL: Exposed file: /config.php"
        print "     â†³ WHY: PHP configuration with database credentials"
        print "     â†³ FIX: Move config outside web root"
        print "     â†³ RISK: Database access, credential theft"
        set $critical $critical + 1
        set $exposed_count $exposed_count + 1
        set $vulnerabilities_found $vulnerabilities_found + 1
    endif
    
    # Check backup files
    GET "$target/backup.sql"
    extract status "" as $backup_status
    if $backup_status == 200 then
        print "  ğŸ”´ CRITICAL: Exposed file: /backup.sql"
        print "     â†³ WHY: Database backup with all data"
        print "     â†³ FIX: Remove backup files from web root"
        print "     â†³ RISK: Complete data breach"
        set $critical $critical + 1
        set $exposed_count $exposed_count + 1
        set $vulnerabilities_found $vulnerabilities_found + 1
    endif
    
    if $exposed_count == 0 then
        print "  âœ… No sensitive files exposed (checked 10+ locations)"
    else
        print ""
        print "  âš ï¸  TOTAL EXPOSED FILES: $exposed_count"
    endif
    
    print ""
endif

# ================================================
# TEST 3: ADVANCED SQL INJECTION
# ================================================
if $stop == 0 then
    print "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    print "â•‘ [3/25] SQL INJECTION - COMPREHENSIVE                      â•‘"
    print "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    set $total_tests $total_tests + 1
    
    print "ğŸ’‰ Testing multiple SQL injection vectors..."
    print ""
    
    # Error-based SQL injection
    GET "$target/search?q='"
    if response contains "SQL syntax" then
        print "  ğŸ”´ CRITICAL: SQL Injection (Error-based)"
        print "     â†³ WHY: Database queries are not properly parameterized"
        print "     â†³ FIX: Use prepared statements/parameterized queries"
        print "     â†³ RISK: Full database access, data theft, data manipulation"
        set $critical $critical + 1
        set $vulnerabilities_found $vulnerabilities_found + 1
    endif
    
    if response contains "mysql_fetch" then
        print "  ğŸ”´ CRITICAL: MySQL error disclosure"
        print "     â†³ WHY: Database errors exposed to users"
        print "     â†³ FIX: Implement proper error handling"
        print "     â†³ RISK: Information disclosure helps attackers"
        set $critical $critical + 1
        set $vulnerabilities_found $vulnerabilities_found + 1
    endif
    
    # Boolean-based blind
    GET "$target/page?id=1 AND 1=1"
    extract status "" as $true_status
    GET "$target/page?id=1 AND 1=2"
    extract status "" as $false_status
    if $true_status != $false_status then
        print "  ğŸ”´ CRITICAL: SQL Injection (Boolean-based blind)"
        print "     â†³ WHY: Application behavior changes based on SQL conditions"
        print "     â†³ FIX: Sanitize all user inputs, use parameterized queries"
        print "     â†³ RISK: Slow data extraction possible"
        set $critical $critical + 1
        set $vulnerabilities_found $vulnerabilities_found + 1
    endif
    
    # Union-based test
    GET "$target/search?q=1' UNION SELECT NULL--"
    if response contains "NULL" then
        print "  ğŸ”´ CRITICAL: SQL Injection (Union-based)"
        print "     â†³ WHY: Allows data extraction from other tables"
        print "     â†³ FIX: Implement input validation and use ORM"
        print "     â†³ RISK: Extract passwords, credit cards, personal data"
        set $critical $critical + 1
        set $vulnerabilities_found $vulnerabilities_found + 1
    endif
    
    print ""
endif

# ================================================
# TEST 4: ADVANCED XSS DETECTION
# ================================================
if $stop == 0 then
    print "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    print "â•‘ [4/25] CROSS-SITE SCRIPTING - ADVANCED                    â•‘"
    print "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    set $total_tests $total_tests + 1
    
    print "ğŸ¯ Testing XSS attack vectors..."
    print ""
    
    set $xss_found 0
    
    # Basic script tag
    GET "$target/search?q=<script>alert(1)</script>"
    if response contains "<script>alert(1)</script>" then
        print "  ğŸ”´ CRITICAL: XSS vulnerability with script tag"
        print "     â†³ WHY: User input not properly encoded/escaped"
        print "     â†³ FIX: HTML encode all user inputs in output"
        print "     â†³ RISK: Session hijacking, credential theft, defacement"
        set $critical $critical + 1
        set $xss_found $xss_found + 1
        set $vulnerabilities_found $vulnerabilities_found + 1
    endif
    
    # Image tag with onerror
    GET "$target/search?q=<img src=x onerror=alert(1)>"
    if response contains "onerror=alert" then
        print "  ğŸ”´ CRITICAL: XSS vulnerability with img tag"
        print "     â†³ WHY: Event handlers not filtered"
        print "     â†³ FIX: Strip all event handlers from user input"
        print "     â†³ RISK: JavaScript execution in user context"
        set $critical $critical + 1
        set $xss_found $xss_found + 1
        set $vulnerabilities_found $vulnerabilities_found + 1
    endif
    
    # SVG tag
    GET "$target/search?q=<svg onload=alert(1)>"
    if response contains "onload=alert" then
        print "  ğŸ”´ CRITICAL: XSS vulnerability with SVG"
        print "     â†³ WHY: SVG tags with scripts allowed"
        print "     â†³ FIX: Whitelist allowed HTML tags"
        print "     â†³ RISK: Bypass common XSS filters"
        set $critical $critical + 1
        set $xss_found $xss_found + 1
        set $vulnerabilities_found $vulnerabilities_found + 1
    endif
    
    # DOM-based XSS check
    GET "$target/#<script>alert(1)</script>"
    if response contains "document.location" then
        if response contains "innerHTML" then
            print "  ğŸŸ  HIGH: Potential DOM-based XSS"
            print "     â†³ WHY: Client-side code processes URL fragments unsafely"
            print "     â†³ FIX: Sanitize DOM manipulation, avoid innerHTML"
            set $high $high + 1
            set $vulnerabilities_found $vulnerabilities_found + 1
        endif
    endif
    
    if $xss_found == 0 then
        print "  âœ… No XSS vulnerabilities found (multiple payloads tested)"
    endif
    
    print ""
endif

# ================================================
# TEST 5: AUTHENTICATION & SESSION SECURITY
# ================================================
if $stop == 0 then
    print "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    print "â•‘ [5/25] AUTHENTICATION & SESSION MANAGEMENT                â•‘"
    print "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    set $total_tests $total_tests + 1
    
    print "ğŸ” Testing authentication mechanisms..."
    print ""
    
    set $weak_creds_found 0
    
    # Test default admin:admin
    POST "$target/login" header "Content-Type" "application/json" body '{"username":"admin","password":"admin"}'
    if status == 200 then
        if response contains "dashboard" then
            print "  ğŸ”´ CRITICAL: Default credentials work: admin:admin"
            print "     â†³ WHY: Using default or weak credentials"
            print "     â†³ FIX: Force password change, implement password policy"
            print "     â†³ RISK: Unauthorized access to admin functions"
            set $critical $critical + 1
            set $weak_creds_found $weak_creds_found + 1
            set $vulnerabilities_found $vulnerabilities_found + 1
        endif
    endif
    
    # Test admin:password
    POST "$target/login" header "Content-Type" "application/json" body '{"username":"admin","password":"password"}'
    if status == 200 then
        if response contains "dashboard" then
            print "  ğŸ”´ CRITICAL: Weak credentials work: admin:password"
            print "     â†³ WHY: Common weak password accepted"
            print "     â†³ FIX: Implement strong password requirements"
            print "     â†³ RISK: Easy brute force success"
            set $critical $critical + 1
            set $weak_creds_found $weak_creds_found + 1
            set $vulnerabilities_found $vulnerabilities_found + 1
        endif
    endif
    
    # Session fixation test
    GET "$target/login?sessionid=FIXED123456"
    extract header "Set-Cookie" as $session_cookie
    if $session_cookie contains "FIXED123456" then
        print "  ğŸ”´ CRITICAL: Session fixation vulnerability"
        print "     â†³ WHY: Accepts user-supplied session IDs"
        print "     â†³ FIX: Regenerate session ID after login"
        print "     â†³ RISK: Attacker can hijack user sessions"
        set $critical $critical + 1
        set $vulnerabilities_found $vulnerabilities_found + 1
    endif
    
    # User enumeration
    POST "$target/login" header "Content-Type" "application/json" body '{"username":"admin_probably_exists","password":"wrong"}'
    if response contains "password incorrect" then
        print "  ğŸŸ¡ MEDIUM: User enumeration possible"
        print "     â†³ WHY: Different responses for valid/invalid users"
        print "     â†³ FIX: Return identical responses for all failures"
        print "     â†³ RISK: Attackers can discover valid usernames"
        set $medium $medium + 1
        set $vulnerabilities_found $vulnerabilities_found + 1
    endif
    
    if $weak_creds_found == 0 then
        print "  âœ… No default credentials accepted"
    endif
    
    print ""
endif

# ================================================
# TEST 6: ACCESS CONTROL & AUTHORIZATION
# ================================================
if $stop == 0 then
    print "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    print "â•‘ [6/25] ACCESS CONTROL & AUTHORIZATION                     â•‘"
    print "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    set $total_tests $total_tests + 1
    
    print "ğŸšª Testing access controls..."
    print ""
    
    # IDOR testing
    GET "$target/api/user/1"
    extract status "" as $user1_status
    GET "$target/api/user/2"
    extract status "" as $user2_status
    if $user1_status == 200 then
        if $user2_status == 200 then
            print "  ğŸ”´ CRITICAL: IDOR - Direct object reference"
            print "     â†³ WHY: No authorization check on object access"
            print "     â†³ FIX: Verify user ownership before data access"
            print "     â†³ RISK: Access any user's private data"
            set $critical $critical + 1
            set $vulnerabilities_found $vulnerabilities_found + 1
        endif
    endif
    
    # Admin panel access
    GET "$target/admin"
    extract status "" as $admin_status
    if $admin_status == 200 then
        print "  ğŸŸ  HIGH: Admin panel accessible without auth"
        print "     â†³ WHY: Administrative interface publicly accessible"
        print "     â†³ FIX: Require authentication, use IP whitelist"
        print "     â†³ RISK: Unauthorized administrative access"
        set $high $high + 1
        set $vulnerabilities_found $vulnerabilities_found + 1
    endif
    
    # Directory traversal
    GET "$target/download?file=../../../etc/passwd"
    if response contains "root:" then
        print "  ğŸ”´ CRITICAL: Path traversal vulnerability"
        print "     â†³ WHY: No path sanitization"
        print "     â†³ FIX: Use whitelist of allowed files"
        print "     â†³ RISK: Read any file on server"
        set $critical $critical + 1
        set $vulnerabilities_found $vulnerabilities_found + 1
    endif
    
    # Directory listing
    GET "$target/uploads/"
    if response contains "Index of" then
        print "  ğŸŸ¡ MEDIUM: Directory listing enabled"
        print "     â†³ WHY: Web server shows directory contents"
        print "     â†³ FIX: Disable directory indexing"
        print "     â†³ RISK: Information disclosure"
        set $medium $medium + 1
        set $vulnerabilities_found $vulnerabilities_found + 1
    endif
    
    print ""
endif

# ================================================
# TEST 7: COMMAND INJECTION
# ================================================
if $stop == 0 then
    print "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    print "â•‘ [7/25] COMMAND INJECTION TESTING                          â•‘"
    print "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    set $total_tests $total_tests + 1
    
    print "ğŸ’£ Testing command injection vulnerabilities..."
    print ""
    
    # Test with semicolon
    GET "$target/ping?host=127.0.0.1;id"
    if response contains "uid=" then
        print "  ğŸ”´ CRITICAL: Command injection vulnerability"
        print "     â†³ WHY: User input passed to system commands"
        print "     â†³ FIX: Never pass user input to system(), use libraries"
        print "     â†³ RISK: Complete server compromise"
        set $critical $critical + 1
        set $vulnerabilities_found $vulnerabilities_found + 1
    endif
    
    # Test with pipe
    GET "$target/ping?host=127.0.0.1|id"
    if response contains "uid=" then
        print "  ğŸ”´ CRITICAL: Command injection (pipe)"
        print "     â†³ WHY: Shell metacharacters not filtered"
        print "     â†³ FIX: Use safe APIs instead of shell commands"
        print "     â†³ RISK: Remote code execution"
        set $critical $critical + 1
        set $vulnerabilities_found $vulnerabilities_found + 1
    endif
    
    print ""
endif

# ================================================
# TEST 8: FILE UPLOAD SECURITY
# ================================================
if $stop == 0 then
    print "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    print "â•‘ [8/25] FILE UPLOAD SECURITY                               â•‘"
    print "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    set $total_tests $total_tests + 1
    
    print "ğŸ“ Testing file upload security..."
    print ""
    
    # Test PHP upload
    POST "$target/upload" body "test.php"
    if response contains "success" then
        print "  ğŸ”´ CRITICAL: PHP files can be uploaded"
        print "     â†³ WHY: No file type validation"
        print "     â†³ FIX: Whitelist allowed extensions"
        print "     â†³ RISK: Remote code execution"
        set $critical $critical + 1
        set $vulnerabilities_found $vulnerabilities_found + 1
    endif
    
    # Test double extension
    POST "$target/upload" body "test.jpg.php"
    if response contains "success" then
        print "  ğŸ”´ CRITICAL: Double extension bypass"
        print "     â†³ WHY: Only checking first extension"
        print "     â†³ FIX: Check all extensions"
        print "     â†³ RISK: Executable file upload"
        set $critical $critical + 1
        set $vulnerabilities_found $vulnerabilities_found + 1
    endif
    
    print ""
endif

# ================================================
# TEST 9: API SECURITY
# ================================================
if $stop == 0 then
if $quick_mode == 0 then
    print "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    print "â•‘ [9/25] API SECURITY ASSESSMENT                            â•‘"
    print "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    set $total_tests $total_tests + 1
    
    print "ğŸ”Œ Testing API security..."
    print ""
    
    # Rate limiting test (reduced from 50 to 10 requests for performance)
    set $rate_limited 0
    repeat 10 times do
        GET "$target/api/users"
        extract status "" as $api_status
        if $api_status == 429 then
            set $rate_limited 1
            break  # Exit early if rate limited
        endif
    endloop
    
    if $rate_limited == 0 then
        print "  ğŸŸ  HIGH: No rate limiting"
        print "     â†³ WHY: API can be abused without limits"
        print "     â†³ FIX: Implement rate limiting (e.g., 100 req/min)"
        print "     â†³ RISK: DoS, brute force, data scraping"
        set $high $high + 1
        set $vulnerabilities_found $vulnerabilities_found + 1
    else
        print "  âœ… Rate limiting active"
    endif
    
    # CORS test
    GET "$target/api" header "Origin" "http://evil.com"
    extract header "Access-Control-Allow-Origin" as $cors
    if $cors == "*" then
        print "  ğŸŸ  HIGH: CORS allows any origin"
        print "     â†³ WHY: No origin validation"
        print "     â†³ FIX: Whitelist allowed origins"
        print "     â†³ RISK: Cross-origin data theft"
        set $high $high + 1
        set $vulnerabilities_found $vulnerabilities_found + 1
    endif
    
    print ""
endif
endif

# ================================================
# TEST 10: COOKIE SECURITY
# ================================================
if $stop == 0 then
    print "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    print "â•‘ [10/25] COOKIE SECURITY ANALYSIS                          â•‘"
    print "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    set $total_tests $total_tests + 1
    
    print "ğŸª Analyzing cookie security..."
    print ""
    
    GET "$target"
    extract header "Set-Cookie" as $cookie
    
    if $cookie empty then
        print "  â„¹ï¸ No cookies set on homepage"
    else
        # Secure flag check
        if $cookie contains "Secure" then
            print "  âœ… Secure flag present"
        else
            print "  ğŸŸ  HIGH: Cookies missing Secure flag"
            print "     â†³ WHY: Cookies sent over HTTP"
            print "     â†³ FIX: Add Secure flag to all cookies"
            print "     â†³ RISK: Cookie theft over insecure connection"
            set $high $high + 1
            set $vulnerabilities_found $vulnerabilities_found + 1
        endif
        
        # HttpOnly check
        if $cookie contains "HttpOnly" then
            print "  âœ… HttpOnly flag present"
        else
            print "  ğŸŸ  HIGH: Cookies accessible to JavaScript"
            print "     â†³ WHY: No HttpOnly protection"
            print "     â†³ FIX: Add HttpOnly flag"
            print "     â†³ RISK: XSS can steal cookies"
            set $high $high + 1
            set $vulnerabilities_found $vulnerabilities_found + 1
        endif
        
        # SameSite check
        if $cookie contains "SameSite" then
            print "  âœ… SameSite attribute present"
        else
            print "  ğŸŸ¡ MEDIUM: Missing SameSite attribute"
            print "     â†³ WHY: No CSRF protection via cookies"
            print "     â†³ FIX: Add SameSite=Lax or Strict"
            print "     â†³ RISK: CSRF attacks possible"
            set $medium $medium + 1
            set $vulnerabilities_found $vulnerabilities_found + 1
        endif
    endif
    
    print ""
endif

# ================================================
# TEST 11: XXE (XML EXTERNAL ENTITY) INJECTION
# ================================================
if $stop == 0 then
    print "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    print "â•‘ [11/25] XXE INJECTION TESTING                             â•‘"
    print "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    set $total_tests $total_tests + 1
    
    print "ğŸ“„ Testing for XXE vulnerabilities..."
    print ""
    
    # Basic XXE test
    POST "$target/api/xml" header "Content-Type" "application/xml" body "<?xml version='1.0'?><!DOCTYPE data [<!ENTITY xxe SYSTEM 'file:///etc/passwd'>]><data>&xxe;</data>"
    if response contains "root:" then
        print "  ğŸ”´ CRITICAL: XXE Injection vulnerability"
        print "     â†³ Issue URL: $target/api/xml"
        print "     â†³ VULNERABILITY EXPLAINED:"
        print "       XXE allows attackers to read local files, perform SSRF attacks,"
        print "       or cause denial of service through entity expansion attacks."
        print "     â†³ ATTACK SCENARIO:"
        print "       Attacker sends malicious XML with external entity definitions"
        print "       Parser processes entities and returns file contents"
        print "     â†³ FIX: Disable external entity processing in XML parser"
        print "       PHP: libxml_disable_entity_loader(true);"
        print "     â†³ RISK LEVEL: Critical - File disclosure, SSRF"
        set $critical $critical + 1
        set $vulnerabilities_found $vulnerabilities_found + 1
        set $critical_issues "$critical_issues|XXE at $target/api/xml"
    endif
    
    print ""
endif

# ================================================
# TEST 12: SSRF (SERVER-SIDE REQUEST FORGERY)
# ================================================
if $stop == 0 then
    print "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    print "â•‘ [12/25] SSRF VULNERABILITY TESTING                        â•‘"
    print "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    set $total_tests $total_tests + 1
    
    print "ğŸŒ Testing for SSRF vulnerabilities..."
    print ""
    
    # SSRF to localhost
    GET "$target/fetch?url=http://127.0.0.1:22"
    if response contains "SSH" then
        print "  ğŸ”´ CRITICAL: SSRF vulnerability detected"
        print "     â†³ Issue URL: $target/fetch?url="
        print "     â†³ VULNERABILITY EXPLAINED:"
        print "       SSRF allows attackers to make the server perform requests to"
        print "       internal resources, bypassing firewalls and accessing internal services."
        print "     â†³ ATTACK SCENARIO:"
        print "       Attacker makes server scan internal network"
        print "       Access cloud metadata endpoints (169.254.169.254)"
        print "       Read internal files via file:// protocol"
        print "     â†³ FIX: Whitelist allowed domains, block private IPs"
        print "       Validate and sanitize all URLs"
        print "     â†³ RISK LEVEL: Critical - Internal network access"
        set $critical $critical + 1
        set $vulnerabilities_found $vulnerabilities_found + 1
        set $critical_issues "$critical_issues|SSRF at $target/fetch"
    endif
    
    # Cloud metadata endpoint test
    GET "$target/fetch?url=http://169.254.169.254/latest/meta-data/"
    if response contains "ami-id" then
        print "  ğŸ”´ CRITICAL: Cloud metadata accessible via SSRF"
        print "     â†³ Issue URL: $target/fetch?url="
        print "     â†³ RISK: AWS credentials and sensitive cloud data exposed"
        set $critical $critical + 1
        set $vulnerabilities_found $vulnerabilities_found + 1
    endif
    
    print ""
endif

# ================================================
# TEST 13: INSECURE DESERIALIZATION
# ================================================
if $stop == 0 then
    print "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    print "â•‘ [13/25] INSECURE DESERIALIZATION                          â•‘"
    print "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    set $total_tests $total_tests + 1
    
    print "ğŸ”“ Testing for deserialization vulnerabilities..."
    print ""
    
    # PHP deserialization test
    POST "$target/api/data" header "Cookie" "data=O:8:stdClass:1:{s:4:test;s:10:phpinfo();};"
    if response contains "phpinfo" then
        print "  ğŸ”´ CRITICAL: Insecure deserialization"
        print "     â†³ Issue URL: $target/api/data"
        print "     â†³ VULNERABILITY EXPLAINED:"
        print "       Deserialization of untrusted data can lead to remote code execution"
        print "       when malicious objects are instantiated with harmful properties."
        print "     â†³ ATTACK SCENARIO:"
        print "       Attacker crafts serialized object with malicious payload"
        print "       Application deserializes and executes arbitrary code"
        print "     â†³ FIX: Never deserialize untrusted data"
        print "       Use JSON instead of native serialization"
        print "     â†³ RISK LEVEL: Critical - Remote code execution"
        set $critical $critical + 1
        set $vulnerabilities_found $vulnerabilities_found + 1
        set $critical_issues "$critical_issues|Deserialization at $target/api/data"
    endif
    
    print ""
endif

# ================================================
# TEST 14: LDAP INJECTION
# ================================================
if $stop == 0 then
    print "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    print "â•‘ [14/25] LDAP INJECTION TESTING                            â•‘"
    print "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    set $total_tests $total_tests + 1
    
    print "ğŸ“‚ Testing for LDAP injection..."
    print ""
    
    # LDAP injection test
    GET "$target/ldap/search?user=*"
    if response contains "cn=" then
        print "  ğŸ”´ CRITICAL: LDAP Injection vulnerability"
        print "     â†³ Issue URL: $target/ldap/search?user="
        print "     â†³ VULNERABILITY EXPLAINED:"
        print "       LDAP injection allows attackers to modify LDAP queries to"
        print "       bypass authentication or extract sensitive directory information."
        print "     â†³ ATTACK SCENARIO:"
        print "       Attacker injects: admin)(&(password=*)"
        print "       Bypasses password check and gains admin access"
        print "     â†³ FIX: Escape special LDAP characters"
        print "       Use parameterized LDAP queries"
        print "     â†³ RISK LEVEL: High - Authentication bypass"
        set $high $high + 1
        set $vulnerabilities_found $vulnerabilities_found + 1
        set $high_issues "$high_issues|LDAP injection at $target/ldap/search"
    endif
    
    print ""
endif

# ================================================
# TEST 15: NOSQL INJECTION
# ================================================
if $stop == 0 then
    print "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    print "â•‘ [15/25] NOSQL INJECTION TESTING                           â•‘"
    print "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    set $total_tests $total_tests + 1
    
    print "ğŸ—„ï¸ Testing for NoSQL injection..."
    print ""
    
    # MongoDB injection test
    POST "$target/api/login" header "Content-Type" "application/json" body '{"username":{"$ne":""},"password":{"$ne":""}}'
    if status == 200 then
        if response contains "authenticated" then
            print "  ğŸ”´ CRITICAL: NoSQL Injection vulnerability"
            print "     â†³ Issue URL: $target/api/login"
            print "     â†³ VULNERABILITY EXPLAINED:"
            print "       NoSQL databases can be vulnerable to injection attacks through"
            print "       query operators like $ne, $gt, $regex that bypass authentication."
            print "     â†³ ATTACK SCENARIO:"
            print "       Attacker sends {username:{$ne:null}} to match any user"
            print "       Bypasses authentication without knowing credentials"
            print "     â†³ FIX: Validate input types, sanitize query operators"
            print "       Cast inputs to expected types"
            print "     â†³ RISK LEVEL: Critical - Authentication bypass"
            set $critical $critical + 1
            set $vulnerabilities_found $vulnerabilities_found + 1
            set $critical_issues "$critical_issues|NoSQL injection at $target/api/login"
        endif
    endif
    
    print ""
endif

# ================================================
# TEST 16: TEMPLATE INJECTION
# ================================================
if $stop == 0 then
    print "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    print "â•‘ [16/25] TEMPLATE INJECTION TESTING                        â•‘"
    print "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    set $total_tests $total_tests + 1
    
    print "ğŸ¨ Testing for template injection..."
    print ""
    
    # SSTI test for various engines
    GET "$target/render?name={{7*7}}"
    if response contains "49" then
        print "  ğŸ”´ CRITICAL: Server-Side Template Injection"
        print "     â†³ Issue URL: $target/render?name="
        print "     â†³ VULNERABILITY EXPLAINED:"
        print "       Template engines execute user input as code when not properly"
        print "       sandboxed, leading to remote code execution."
        print "     â†³ ATTACK SCENARIO:"
        print "       Attacker injects template syntax: {{system('id')}}"
        print "       Template engine executes system commands"
        print "     â†³ FIX: Never pass user input directly to templates"
        print "       Use template sandboxing, validate all inputs"
        print "     â†³ RISK LEVEL: Critical - Remote code execution"
        set $critical $critical + 1
        set $vulnerabilities_found $vulnerabilities_found + 1
        set $critical_issues "$critical_issues|SSTI at $target/render"
    endif
    
    print ""
endif

# ================================================
# TEST 17: OPEN REDIRECT
# ================================================
if $stop == 0 then
    print "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    print "â•‘ [17/25] OPEN REDIRECT TESTING                             â•‘"
    print "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    set $total_tests $total_tests + 1
    
    print "â†—ï¸ Testing for open redirect vulnerabilities..."
    print ""
    
    # Open redirect test
    GET "$target/redirect?url=http://evil.com"
    extract header "Location" as $redirect_location
    if $redirect_location contains "evil.com" then
        print "  ğŸŸ¡ MEDIUM: Open redirect vulnerability"
        print "     â†³ Issue URL: $target/redirect?url="
        print "     â†³ VULNERABILITY EXPLAINED:"
        print "       Application redirects users to attacker-controlled sites,"
        print "       enabling phishing attacks and credential theft."
        print "     â†³ ATTACK SCENARIO:"
        print "       Attacker sends legitimate-looking link with redirect"
        print "       Victim trusts domain, gets redirected to phishing site"
        print "     â†³ FIX: Whitelist allowed redirect destinations"
        print "       Use relative URLs only, validate absolute URLs"
        print "     â†³ RISK LEVEL: Medium - Phishing enabler"
        set $medium $medium + 1
        set $vulnerabilities_found $vulnerabilities_found + 1
        set $medium_issues "$medium_issues|Open redirect at $target/redirect"
    endif
    
    print ""
endif

# ================================================
# TEST 18: CACHE POISONING
# ================================================
if $stop == 0 then
    print "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    print "â•‘ [18/25] CACHE POISONING TESTING                           â•‘"
    print "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    set $total_tests $total_tests + 1
    
    print "ğŸ’‰ Testing for cache poisoning..."
    print ""
    
    # Cache poisoning test
    GET "$target" header "X-Forwarded-Host" "evil.com"
    if response contains "evil.com" then
        print "  ğŸŸ  HIGH: Cache poisoning possible"
        print "     â†³ Issue URL: $target"
        print "     â†³ VULNERABILITY EXPLAINED:"
        print "       Unkeyed headers in cache can be manipulated to serve"
        print "       malicious content to other users from cache."
        print "     â†³ ATTACK SCENARIO:"
        print "       Attacker poisons cache with malicious headers"
        print "       All users receive poisoned response from cache"
        print "     â†³ FIX: Include all headers in cache key"
        print "       Validate header values, disable unnecessary headers"
        print "     â†³ RISK LEVEL: High - Affects all cached users"
        set $high $high + 1
        set $vulnerabilities_found $vulnerabilities_found + 1
        set $high_issues "$high_issues|Cache poisoning at $target"
    endif
    
    print ""
endif

# ================================================
# TEST 19: HTTP REQUEST SMUGGLING
# ================================================
if $stop == 0 then
    print "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    print "â•‘ [19/25] HTTP REQUEST SMUGGLING                            â•‘"
    print "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    set $total_tests $total_tests + 1
    
    print "ğŸš¥ Testing for request smuggling..."
    print ""
    
    # CL.TE smuggling test
    POST "$target/" header "Content-Length" "13" body "0\r\n\r\nGET /admin HTTP/1.1\r\nHost: $target\r\n\r\n"
    if response contains "admin" then
        print "  ğŸ”´ CRITICAL: HTTP Request Smuggling detected"
        print "     â†³ Issue URL: $target/"
        print "     â†³ VULNERABILITY EXPLAINED:"
        print "       Discrepancies in how front-end and back-end servers parse"
        print "       HTTP requests allow smuggling requests to bypass security."
        print "     â†³ ATTACK SCENARIO:"
        print "       Attacker smuggles requests to access restricted endpoints"
        print "       Bypasses authentication and WAF rules"
        print "     â†³ FIX: Normalize request handling across all servers"
        print "       Use HTTP/2, reject ambiguous requests"
        print "     â†³ RISK LEVEL: Critical - Security bypass"
        set $critical $critical + 1
        set $vulnerabilities_found $vulnerabilities_found + 1
        set $critical_issues "$critical_issues|Request smuggling at $target/"
    endif
    
    print ""
endif

# ================================================
# TEST 20: WEBSOCKET SECURITY
# ================================================
if $stop == 0 then
    print "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    print "â•‘ [20/25] WEBSOCKET SECURITY                                â•‘"
    print "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    set $total_tests $total_tests + 1
    
    print "ğŸ”Œ Testing WebSocket security..."
    print ""
    
    # WebSocket origin check
    GET "$target/ws" header "Origin" "http://evil.com"
    if status == 101 then
        print "  ğŸŸ  HIGH: WebSocket accepts any origin"
        print "     â†³ Issue URL: $target/ws"
        print "     â†³ VULNERABILITY EXPLAINED:"
        print "       WebSocket connections without origin validation allow"
        print "       cross-site WebSocket hijacking attacks."
        print "     â†³ ATTACK SCENARIO:"
        print "       Attacker's site connects to victim's WebSocket session"
        print "       Hijacks real-time communication channel"
        print "     â†³ FIX: Validate Origin header in WebSocket handshake"
        print "       Implement CSRF tokens for WebSocket connections"
        print "     â†³ RISK LEVEL: High - Session hijacking"
        set $high $high + 1
        set $vulnerabilities_found $vulnerabilities_found + 1
        set $high_issues "$high_issues|WebSocket origin at $target/ws"
    endif
    
    print ""
endif

# ================================================
# TEST 21: GRAPHQL SECURITY
# ================================================
if $stop == 0 then
    print "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    print "â•‘ [21/25] GRAPHQL SECURITY ASSESSMENT                       â•‘"
    print "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    set $total_tests $total_tests + 1
    
    print "ğŸ“Š Testing GraphQL security..."
    print ""
    
    # GraphQL introspection test
    POST "$target/graphql" header "Content-Type" "application/json" body '{"query":"{ __schema { types { name } } }"}'
    if response contains "__schema" then
        print "  ğŸŸ¡ MEDIUM: GraphQL introspection enabled"
        print "     â†³ Issue URL: $target/graphql"
        print "     â†³ VULNERABILITY EXPLAINED:"
        print "       Introspection reveals entire API schema, all queries,"
        print "       mutations, and types available to attackers."
        print "     â†³ ATTACK SCENARIO:"
        print "       Attacker maps entire API structure"
        print "       Discovers hidden endpoints and sensitive operations"
        print "     â†³ FIX: Disable introspection in production"
        print "       Implement query depth limiting"
        print "     â†³ RISK LEVEL: Medium - Information disclosure"
        set $medium $medium + 1
        set $vulnerabilities_found $vulnerabilities_found + 1
        set $medium_issues "$medium_issues|GraphQL introspection at $target/graphql"
    endif
    
    print ""
endif

# ================================================
# TEST 22: JWT SECURITY
# ================================================
if $stop == 0 then
    print "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    print "â•‘ [22/25] JWT TOKEN SECURITY                                â•‘"
    print "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    set $total_tests $total_tests + 1
    
    print "ğŸ” Testing JWT security..."
    print ""
    
    # JWT none algorithm test
    GET "$target/api/user" header "Authorization" "Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJzdWIiOiJhZG1pbiJ9."
    if status == 200 then
        print "  ğŸ”´ CRITICAL: JWT accepts 'none' algorithm"
        print "     â†³ Issue URL: $target/api/user"
        print "     â†³ VULNERABILITY EXPLAINED:"
        print "       JWT with 'none' algorithm bypasses signature verification,"
        print "       allowing attackers to forge any token."
        print "     â†³ ATTACK SCENARIO:"
        print "       Attacker creates JWT with alg:none and admin claims"
        print "       Server accepts unsigned token as valid"
        print "     â†³ FIX: Explicitly verify algorithm, reject 'none'"
        print "       Use strong signing keys (RS256, HS256)"
        print "     â†³ RISK LEVEL: Critical - Authentication bypass"
        set $critical $critical + 1
        set $vulnerabilities_found $vulnerabilities_found + 1
        set $critical_issues "$critical_issues|JWT none algorithm at $target/api/user"
    endif
    
    print ""
endif

# ================================================
# TEST 23: SUBDOMAIN TAKEOVER
# ================================================
if $stop == 0 then
    print "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    print "â•‘ [23/25] SUBDOMAIN TAKEOVER CHECK                          â•‘"
    print "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    set $total_tests $total_tests + 1
    
    print "ğŸ¯ Checking for subdomain takeover..."
    print ""
    
    # Check common subdomains - extract domain from URL
    set $url_parts split $target "://"
    if length $url_parts > 1 then
        set $domain_with_path $url_parts[1]
        set $domain_parts split $domain_with_path "/"
        set $domain $domain_parts[0]
        
        # Check blog subdomain
        GET "http://blog.$domain"
        if response contains "There isn't a GitHub Pages site here" then
            print "  ğŸŸ  HIGH: Subdomain takeover possible (GitHub Pages)"
            print "     â†³ Issue URL: blog.$domain"
            print "     â†³ VULNERABILITY EXPLAINED:"
            print "       Subdomain points to unclaimed service allowing attackers"
            print "       to claim the service and host malicious content."
            print "     â†³ ATTACK SCENARIO:"
            print "       Attacker claims GitHub Pages for blog.$domain"
            print "       Hosts phishing site on legitimate subdomain"
            print "     â†³ FIX: Remove DNS records for unused services"
            print "       Claim all configured services"
            print "     â†³ RISK LEVEL: High - Domain reputation damage"
            set $high $high + 1
            set $vulnerabilities_found $vulnerabilities_found + 1
            set $high_issues "$high_issues|Subdomain takeover at blog.$domain"
        endif
    else
        print "  â„¹ï¸ Could not extract domain from URL format"
    endif
    
    print ""
endif

# ================================================
# TEST 24: PROTOTYPE POLLUTION
# ================================================
if $stop == 0 then
    print "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    print "â•‘ [24/25] PROTOTYPE POLLUTION TESTING                       â•‘"
    print "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    set $total_tests $total_tests + 1
    
    print "ğŸ§¬ Testing for prototype pollution..."
    print ""
    
    # Prototype pollution test
    POST "$target/api/update" header "Content-Type" "application/json" body '{"__proto__":{"isAdmin":true}}'
    GET "$target/api/user"
    if response contains "isAdmin.*true" then
        print "  ğŸ”´ CRITICAL: Prototype pollution vulnerability"
        print "     â†³ Issue URL: $target/api/update"
        print "     â†³ VULNERABILITY EXPLAINED:"
        print "       Modifying Object prototype affects all objects in application,"
        print "       potentially bypassing security checks."
        print "     â†³ ATTACK SCENARIO:"
        print "       Attacker pollutes Object.prototype with isAdmin:true"
        print "       All objects inherit admin privileges"
        print "     â†³ FIX: Freeze Object.prototype, validate property names"
        print "       Use Map instead of objects for user input"
        print "     â†³ RISK LEVEL: Critical - Privilege escalation"
        set $critical $critical + 1
        set $vulnerabilities_found $vulnerabilities_found + 1
        set $critical_issues "$critical_issues|Prototype pollution at $target/api/update"
    endif
    
    print ""
endif

# ================================================
# TEST 25: BUSINESS LOGIC FLAWS
# ================================================
if $stop == 0 then
    print "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    print "â•‘ [25/25] BUSINESS LOGIC TESTING                            â•‘"
    print "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    set $total_tests $total_tests + 1
    
    print "ğŸ’° Testing business logic security..."
    print ""
    
    # Negative value test
    POST "$target/api/transfer" header "Content-Type" "application/json" body '{"amount":-100,"to":"attacker"}'
    if response contains "success" then
        print "  ğŸ”´ CRITICAL: Negative value accepted in transfer"
        print "     â†³ Issue URL: $target/api/transfer"
        print "     â†³ VULNERABILITY EXPLAINED:"
        print "       Business logic flaw allows negative amounts, potentially"
        print "       reversing transaction flow or bypassing validations."
        print "     â†³ ATTACK SCENARIO:"
        print "       Attacker transfers -$100 (receives $100)"
        print "       Bypasses balance checks and limits"
        print "     â†³ FIX: Validate all numeric inputs > 0"
        print "       Implement comprehensive business rule validation"
        print "     â†³ RISK LEVEL: Critical - Financial loss"
        set $critical $critical + 1
        set $vulnerabilities_found $vulnerabilities_found + 1
        set $critical_issues "$critical_issues|Logic flaw at $target/api/transfer"
    endif
    
    # Race condition test (TOCTOU)
    POST "$target/api/purchase" header "Content-Type" "application/json" body '{"item":"premium","quantity":1}'
    POST "$target/api/purchase" header "Content-Type" "application/json" body '{"item":"premium","quantity":1}'
    if response contains "insufficient" then
        print "  â„¹ï¸ INFO: Potential race condition in purchase flow"
        print "     â†³ Testing for time-of-check to time-of-use issues"
        set $info $info + 1
    endif
    
    print ""
endif

# ================================================
# COMPREHENSIVE FINAL REPORT
# ================================================
if $stop == 0 then
    print "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    print "â•‘         ENTERPRISE SECURITY ASSESSMENT REPORT v3          â•‘"
    print "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    print ""
    print "ğŸ“Š EXECUTIVE SUMMARY"
    print "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    print ""
    print "Target System: $target"
    print "Total Tests Performed: $total_tests"
    print ""
    
    # Calculate total vulnerabilities
    set $total_vulns $critical + $high + $medium + $low
    
    print "â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”"
    print "â”‚           VULNERABILITY STATISTICS             â”‚"
    print "â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤"
    print "â”‚  ğŸ”´ CRITICAL:     $critical vulnerabilities    â”‚"
    print "â”‚  ğŸŸ  HIGH:         $high vulnerabilities        â”‚"
    print "â”‚  ğŸŸ¡ MEDIUM:       $medium vulnerabilities      â”‚"
    print "â”‚  ğŸ”µ LOW:          $low vulnerabilities         â”‚"
    print "â”‚  â„¹ï¸  INFO:         $info findings              â”‚"
    print "â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤"
    print "â”‚  TOTAL:           $total_vulns vulnerabilities â”‚"
    print "â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
    print ""
    
    # Risk score calculation
    set $risk_score $critical * 50
    set $risk_score $risk_score + $high * 20
    set $risk_score $risk_score + $medium * 5
    set $risk_score $risk_score + $low * 1
    
    print "ğŸ¯ OVERALL RISK SCORE: $risk_score"
    print ""
    
    # Risk level determination with detailed recommendations
    if $risk_score >= 100 then
        print "â›” CRITICAL RISK LEVEL - IMMEDIATE ACTION REQUIRED"
        print "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
        print ""
        print "ğŸ“‹ EMERGENCY RESPONSE PLAN:"
        print ""
        print "1. IMMEDIATE ACTIONS (Within 2 hours):"
        print "   â€¢ Activate incident response team"
        print "   â€¢ Consider taking affected systems offline"
        print "   â€¢ Deploy emergency Web Application Firewall rules"
        print "   â€¢ Block suspicious IP addresses"
        print ""
        print "2. SHORT-TERM FIXES (Within 24 hours):"
        print "   â€¢ Patch all CRITICAL vulnerabilities"
        print "   â€¢ Implement input validation"
        print "   â€¢ Reset all administrative credentials"
        print ""
        print "3. MEDIUM-TERM IMPROVEMENTS (Within 1 week):"
        print "   â€¢ Conduct thorough code review"
        print "   â€¢ Implement security headers"
        print "   â€¢ Deploy rate limiting"
        print ""
    else
        if $risk_score >= 50 then
            print "âš ï¸  HIGH RISK LEVEL - URGENT REMEDIATION REQUIRED"
            print "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
            print ""
            print "ğŸ“‹ REMEDIATION PLAN:"
            print ""
            print "1. PRIORITY FIXES (Within 48 hours):"
            print "   â€¢ Address all CRITICAL vulnerabilities"
            print "   â€¢ Fix authentication issues"
            print "   â€¢ Implement security headers"
            print ""
            print "2. SECONDARY FIXES (Within 1 week):"
            print "   â€¢ Address HIGH severity issues"
            print "   â€¢ Enable rate limiting"
            print ""
        else
            if $risk_score >= 20 then
                print "âš ï¸  MEDIUM RISK LEVEL - PLANNED REMEDIATION"
                print "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
                print ""
                print "ğŸ“‹ IMPROVEMENT PLAN:"
                print ""
                print "1. Schedule fixes for next release"
                print "2. Implement security best practices"
                print "3. Regular security updates"
            else
                if $total_vulns > 0 then
                    print "â„¹ï¸  LOW RISK LEVEL - MINOR IMPROVEMENTS NEEDED"
                    print "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
                    print ""
                    print "ğŸ“‹ RECOMMENDATIONS:"
                    print ""
                    print "1. Address in routine maintenance"
                    print "2. Continue security monitoring"
                else
                    print "âœ… SECURE - EXCELLENT SECURITY POSTURE"
                    print "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
                    print ""
                    print "No significant vulnerabilities detected."
                    print "Continue with regular security assessments."
                endif
            endif
        endif
    endif
    
    print ""
    print "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    print "ğŸ“ COMPLIANCE STATUS"
    print "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    print ""
    
    # OWASP Top 10 Coverage
    print "OWASP Top 10 (2021) Coverage:"
    print "  â€¢ A01: Broken Access Control        âœ“ Tested"
    print "  â€¢ A02: Cryptographic Failures       âœ“ Tested"
    print "  â€¢ A03: Injection                    âœ“ Tested"
    print "  â€¢ A04: Insecure Design             âœ“ Tested"
    print "  â€¢ A05: Security Misconfiguration   âœ“ Tested"
    print "  â€¢ A07: Auth & Identity Failures    âœ“ Tested"
    print "  â€¢ A08: Data Integrity Failures     âœ“ Tested"
    print "  â€¢ A10: SSRF                        âœ“ Tested"
    print ""
    
    # Compliance recommendations
    if $critical > 0 then
        print "âš ï¸  NOT COMPLIANT - Critical issues must be resolved"
    else
        if $high > 5 then
            print "âš ï¸  PARTIAL COMPLIANCE - High-risk issues need attention"
        else
            print "âœ… COMPLIANT - Meets basic security standards"
        endif
    endif
    
    # Detailed vulnerability URLs section
    if $total_vulns > 0 then
        print ""
        print "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
        print "ğŸ“ VULNERABILITY LOCATIONS - DETAILED REPORT"
        print "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
        print ""
        
        if $critical > 0 then
            print "ğŸ”´ CRITICAL VULNERABILITIES FOUND:"
            print "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
            print "$critical_issues"
            print ""
        endif
        
        if $high > 0 then
            print "ğŸŸ  HIGH SEVERITY VULNERABILITIES:"
            print "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
            print "$high_issues"
            print ""
        endif
        
        if $medium > 0 then
            print "ğŸŸ¡ MEDIUM SEVERITY VULNERABILITIES:"
            print "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
            print "$medium_issues"
            print ""
        endif
        
        if $low > 0 then
            print "ğŸ”µ LOW SEVERITY VULNERABILITIES:"
            print "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
            print "$low_issues"
            print ""
        endif
    endif
    
    print ""
    print "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    print "ğŸ’¡ VULNERABILITY EXPLANATIONS SUMMARY"
    print "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    print ""
    print "Each vulnerability detected includes:"
    print "â€¢ Exact URL where the issue was found"
    print "â€¢ Detailed technical explanation"
    print "â€¢ Real-world attack scenarios"
    print "â€¢ Specific remediation steps with code examples"
    print "â€¢ Risk level assessment"
    print ""
    print "Review the detailed findings above for complete information."
    print ""
    print "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    print "Report Generated by Enterprise Security Scanner v3.0"
    print "Complete Edition with 25 vulnerability tests"
    print "For detailed remediation: security@company.com"
    print "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
endif