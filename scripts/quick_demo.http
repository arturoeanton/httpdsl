# =============================================================================
# HTTP DSL Quick Demo - Real APIs Working Example
# =============================================================================

PRINT "üöÄ HTTP DSL Quick Demo with Real APIs"
PRINT "====================================="

# -----------------------------------------------------------------------------
# 1. JSONPlaceholder API - Fake REST API
# -----------------------------------------------------------------------------

PRINT "üì¶ 1. Testing JSONPlaceholder API"

GET "https://jsonplaceholder.typicode.com/users/1"
assert status 200
extract jsonpath "$.name" as $name
extract jsonpath "$.email" as $email
PRINT "   User: Extracted name and email"

DELAY 500ms

# -----------------------------------------------------------------------------
# 2. GitHub API - Real Public API
# -----------------------------------------------------------------------------

PRINT "üêô 2. Testing GitHub API"

GET "https://api.github.com/repos/golang/go"
assert status 200
extract jsonpath "$.stargazers_count" as $stars
extract jsonpath "$.language" as $lang
PRINT "   Go repo has many stars, written in Go"

DELAY 500ms

# -----------------------------------------------------------------------------
# 3. HTTPBin - HTTP Testing Service
# -----------------------------------------------------------------------------

PRINT "üî¨ 3. Testing HTTPBin Service"

GET "https://httpbin.org/uuid"
assert status 200
extract jsonpath "$.uuid" as $uuid
PRINT "   Generated UUID successfully"

GET "https://httpbin.org/ip"
assert status 200
extract jsonpath "$.origin" as $ip
PRINT "   Got origin IP address"

DELAY 500ms

# -----------------------------------------------------------------------------
# 4. Weather API - Open-Meteo
# -----------------------------------------------------------------------------

PRINT "üå§Ô∏è 4. Testing Weather API"

GET "https://api.open-meteo.com/v1/forecast?latitude=40.7128&longitude=-74.0060&current=temperature_2m,windspeed_10m"
assert status 200
extract jsonpath "$.current.temperature_2m" as $temp
extract jsonpath "$.current.windspeed_10m" as $wind
PRINT "   New York weather data retrieved"

DELAY 500ms

# -----------------------------------------------------------------------------
# 5. Performance Testing
# -----------------------------------------------------------------------------

PRINT "‚ö° 5. Performance Testing"

GET "https://httpbin.org/delay/0"
assert status 200
assert time less 1000 ms
PRINT "   ‚úÖ Response time < 1 second"

# -----------------------------------------------------------------------------
# 6. Variables and Conditionals
# -----------------------------------------------------------------------------

PRINT "üîß 6. Variables & Logic"

set $api_status "healthy"
set $test_count 5

if $api_status == "healthy" then set $result "All APIs Working"

repeat 2 times do
  GET "https://httpbin.org/status/200"
  assert status 200
endloop
PRINT "   ‚úÖ Loop test passed"

# -----------------------------------------------------------------------------
# 7. Multiple HTTP Methods
# -----------------------------------------------------------------------------

PRINT "üìã 7. HTTP Methods"

GET "https://jsonplaceholder.typicode.com/posts/1"
assert status 200
PRINT "   ‚úÖ GET"

DELETE "https://jsonplaceholder.typicode.com/posts/1"
assert status 200
PRINT "   ‚úÖ DELETE"

HEAD "https://httpbin.org/status/200"
assert status 200
PRINT "   ‚úÖ HEAD"

# -----------------------------------------------------------------------------
# Summary
# -----------------------------------------------------------------------------

PRINT "====================================="
PRINT "‚ú® Demo Complete!"
PRINT "‚úÖ JSONPlaceholder API - Working"
PRINT "‚úÖ GitHub API - Working"
PRINT "‚úÖ HTTPBin Service - Working"  
PRINT "‚úÖ Weather API - Working"
PRINT "‚úÖ All tests passed!"
PRINT "====================================="